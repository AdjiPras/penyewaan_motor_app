{% extends 'rental/base.html' %}
{% block content %}
<div class="container my-4">
  <h2 class="mb-4 text-center">Dashboard ({{ bulan }})</h2>

  <div class="row g-4 justify-content-center">

    <!-- Diagram Merk Motor -->
    <div class="col-12 col-md-4">
      <div class="card shadow-sm h-100">
        <div class="card-header bg-secondary text-white text-center">
          <h5 class="mb-0">Jumlah Motor per Merk</h5>
        </div>
        <div class="card-body d-flex justify-content-center align-items-center" style="height: 320px;">
          <canvas id="merkMotorChart" style="max-width: 100%; max-height: 300px;"></canvas>
        </div>
      </div>
    </div>

    <!-- Diagram Data Motor -->
    <div class="col-12 col-md-4">
      <div class="card shadow-sm h-100">
        <div class="card-header bg-primary text-white text-center">
          <h5 class="mb-0">Data Motor</h5>
        </div>
        <div class="card-body d-flex justify-content-center align-items-center" style="height: 320px;">
          <canvas id="motorChart" style="max-width: 100%; max-height: 300px;"></canvas>
        </div>
      </div>
    </div>

    <!-- Diagram Transaksi -->
    <div class="col-12 col-md-4">
      <div class="card shadow-sm h-100">
        <div class="card-header bg-info text-white text-center">
          <h5 class="mb-0">Data Transaksi</h5>
        </div>
        <div class="card-body d-flex justify-content-center align-items-center" style="height: 320px;">
          <canvas id="transaksiChart" style="max-width: 100%; max-height: 300px;"></canvas>
        </div>
      </div>
    </div>

  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Diagram Merk Motor
  const merkCtx = document.getElementById('merkMotorChart').getContext('2d');
  new Chart(merkCtx, {
    type: 'pie',
    data: {
      labels: {{ merk_labels|safe }},
      datasets: [{
        label: 'Jumlah Motor per Merk',
        data: {{ merk_counts|safe }},
        backgroundColor: [
          '#007bff', '#28a745', '#ffc107', '#dc3545', '#6f42c1',
          '#fd7e14', '#20c997', '#6610f2', '#e83e8c', '#0d6efd'
        ],
      }]
    },
    options: { responsive: true, maintainAspectRatio: false }
  });

  // Diagram Data Motor (total motor)
//   const motorCtx = document.getElementById('motorChart').getContext('2d');
//   new Chart(motorCtx, {
//     type: 'pie',
//     data: {
//       labels: ['Total Motor'],
//       datasets: [{
//         label: 'Motor',
//         data: [{{ jumlah_motor }}],
//         backgroundColor: ['#0d6efd'],
//       }]
//     },
//     options: { responsive: true, maintainAspectRatio: false }
//   });

  // Diagram Data Transaksi
  const transaksiCtx = document.getElementById('transaksiChart').getContext('2d');
  new Chart(transaksiCtx, {
    type: 'pie',
    data: {
      labels: ['Transaksi', 'Transaksi Selesai'],
      datasets: [{
        label: 'Transaksi',
        data: [{{ jumlah_transaksi }}, {{ transaksi_selesai }}],
        backgroundColor: ['#0dcaf0', '#198754'],
      }]
    },
    options: { responsive: true, maintainAspectRatio: false }
  });
</script>
{% endblock %}
